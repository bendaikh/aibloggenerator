import{r as u,E as S,g as r,i as c,t as x,b as t,n as T,e as f,f as z,k as j,v as F,G,K as V,o as n}from"./app-C4h8ruHX.js";const L={class:"image-upload"},N={key:0,class:"block text-sm font-medium text-gray-300 mb-2"},R={key:1,class:"mb-3"},E={class:"relative inline-block"},K=["src","alt"],$={key:2,class:"relative"},H=["accept"],J={key:0,class:"flex flex-col items-center"},W={key:1,class:"flex flex-col items-center"},A={class:"text-gray-500 text-xs"},O={key:3,class:"mt-3"},q={key:0,class:"mt-2"},Q=["onKeydown"],X={key:4,class:"mt-2 text-sm text-red-500"},Z={__name:"ImageUpload",props:{modelValue:{type:String,default:""},label:{type:String,default:""},type:{type:String,default:"article"},hint:{type:String,default:""},allowUrl:{type:Boolean,default:!0},acceptedTypes:{type:String,default:"image/jpeg,image/png,image/gif,image/webp"},maxSize:{type:Number,default:5*1024*1024}},emits:["update:modelValue"],setup(l,{emit:U}){const m=l,y=U,b=u(null),v=u(!1),i=u(!1),s=u(""),g=u(!1),d=u(""),p=u(""),C=()=>{i.value||b.value?.click()},I=a=>{const e=a.target.files?.[0];e&&w(e),a.target.value=""},M=a=>{v.value=!1;const e=a.dataTransfer?.files?.[0];e&&w(e)},w=async a=>{if(s.value="",!m.acceptedTypes.split(",").includes(a.type)){s.value="Invalid file type. Please upload an image (PNG, JPG, GIF, WebP).";return}if(a.size>m.maxSize){s.value=`File is too large. Maximum size is ${Math.round(m.maxSize/1024/1024)}MB.`;return}i.value=!0;try{const o=new FormData;o.append("image",a),o.append("type",m.type);const h=await V.post("/upload/image",o,{headers:{"Content-Type":"multipart/form-data"}});h.data.success?(p.value=h.data.path,y("update:modelValue",h.data.url)):s.value="Upload failed. Please try again."}catch(o){console.error("Upload error:",o),s.value=o.response?.data?.message||"Upload failed. Please try again."}finally{i.value=!1}},B=async()=>{if(p.value)try{await V.delete("/upload/image",{data:{path:p.value}})}catch(a){console.error("Delete error:",a)}p.value="",y("update:modelValue","")},k=()=>{d.value&&D(d.value)?(y("update:modelValue",d.value),g.value=!1,d.value=""):d.value&&(s.value="Please enter a valid URL.")},D=a=>{try{return new URL(a),!0}catch{return!1}},P=()=>{s.value="Failed to load image. The URL may be invalid or inaccessible."};return S(()=>m.modelValue,a=>{a||(p.value="")}),(a,e)=>(n(),r("div",L,[l.label?(n(),r("label",N,x(l.label),1)):c("",!0),l.modelValue&&!i.value?(n(),r("div",R,[t("div",E,[t("img",{src:l.modelValue,alt:l.label||"Image preview",class:"h-32 w-auto rounded-lg object-cover border border-[#3a3a3a]",onError:P},null,40,K),t("button",{type:"button",onClick:B,class:"absolute -top-2 -right-2 w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center transition-colors",title:"Remove image"},[...e[4]||(e[4]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])])])):c("",!0),!l.modelValue||i.value?(n(),r("div",$,[t("div",{onDragover:e[0]||(e[0]=f(o=>v.value=!0,["prevent"])),onDragleave:e[1]||(e[1]=f(o=>v.value=!1,["prevent"])),onDrop:f(M,["prevent"]),class:T(["border-2 border-dashed rounded-lg p-6 text-center transition-all cursor-pointer",v.value?"border-emerald-500 bg-emerald-900/20":"border-[#3a3a3a] hover:border-[#4a4a4a]",i.value?"pointer-events-none opacity-60":""]),onClick:C},[t("input",{ref_key:"fileInput",ref:b,type:"file",accept:l.acceptedTypes,class:"hidden",onChange:I},null,40,H),i.value?(n(),r("div",J,[...e[5]||(e[5]=[t("svg",{class:"animate-spin h-8 w-8 text-emerald-500 mb-2",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),t("p",{class:"text-gray-400 text-sm"},"Uploading...",-1)])])):(n(),r("div",W,[e[6]||(e[6]=t("div",{class:"w-12 h-12 bg-[#252525] rounded-lg flex items-center justify-center mb-3"},[t("svg",{class:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})])],-1)),e[7]||(e[7]=t("p",{class:"text-white text-sm font-medium mb-1"}," Drop an image here or click to browse ",-1)),t("p",A,x(l.hint||"PNG, JPG, GIF, WebP up to 5MB"),1)]))],34)])):c("",!0),l.allowUrl&&!l.modelValue?(n(),r("div",O,[t("button",{type:"button",onClick:e[2]||(e[2]=o=>g.value=!g.value),class:"text-sm text-gray-400 hover:text-white flex items-center gap-1"},[...e[8]||(e[8]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})],-1),z(" Or use image URL ",-1)])]),g.value?(n(),r("div",q,[j(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>d.value=o),type:"url",placeholder:"https://example.com/image.jpg",class:"w-full bg-[#252525] border border-[#3a3a3a] text-white px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-sm",onBlur:k,onKeydown:G(f(k,["prevent"]),["enter"])},null,40,Q),[[F,d.value]])])):c("",!0)])):c("",!0),s.value?(n(),r("p",X,x(s.value),1)):c("",!0)]))}};export{Z as _};
